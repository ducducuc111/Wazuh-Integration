/*
  Chức năng này sẽ hỗ trợ phát hiện những phiên bản HĐH và package đã lỗi thời và có tồn tại các CVE đã biết, cũng như đánh giá mức độ
  nghiêm trọng của CVE thông qua điểm số và mức độ, từ đó giúp quản trị viên có cái nhìn rõ ràng hơn.
*/

########################################################## WAZUH Manager ##############################################################
/*
  Các thiết lập trong thẻ <enabled> cần được đặt thành "yes" để kích hoạt chức năng phát hiện và nền tảng kiến trúc HĐH mà ta muốn theo dõi.
  Cần lưu ý những OS mà Wazuh hỗ trợ thì mới hoạt động.
  Lưu ý: Các thiết lập ban đầu này sẽ cần một khoảng thời gian để hệ thống cập nhật CSDL phát hiện CVE trong /var/ossec/queue/vulnerabilities/cve.db
  tuỳ vào tốc độ mạng mà điều này có thể nhanh hoặc chậm. Chỉ khi cập nhật hoàn thành thì bước quét CVE mới được bắt đầu
  
  Kiểm tra cập nhật CSDL CVE trong log: cat /var/ossec/logs/ossec.log | grep -i "vulnerability-detector"
  Kiểm tra hệ thống quét khi nào: cat /var/ossec/logs/ossec.log | grep -i "Starting vulnerability scan"
*/

nano /var/ossec/etc/ossec.conf

<vulnerability-detector>
    <enabled>yes</enabled>
    <interval>5m</interval>
    <ignore_time>5m</ignore_time>
    <run_on_start>yes</run_on_start>

    <!-- Ubuntu OS vulnerabilities -->
    <provider name="canonical">
      <enabled>yes</enabled>
      <os>trusty</os>
      <os>xenial</os>
      <os>bionic</os>
      <os>focal</os>
      <os>jammy</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Debian OS vulnerabilities -->
    <provider name="debian">
      <enabled>yes</enabled>
      <os>buster</os>
      <os>bullseye</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- RedHat OS vulnerabilities -->
    <provider name="redhat">
      <enabled>yes</enabled>
      <os>5</os>
      <os>6</os>
      <os>7</os>
      <os>8</os>
      <os>9</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Amazon Linux OS vulnerabilities -->
    <provider name="alas">
      <enabled>yes</enabled>
      <os>amazon-linux</os>
      <os>amazon-linux-2</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- SUSE OS vulnerabilities -->
    <provider name="suse">
      <enabled>yes</enabled>
      <os>11-server</os>
      <os>11-desktop</os>
      <os>12-server</os>
      <os>12-desktop</os>
      <os>15-server</os>
      <os>15-desktop</os>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Arch OS vulnerabilities -->
    <provider name="arch">
      <enabled>yes</enabled>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Windows OS vulnerabilities -->
    <provider name="msu">
      <enabled>yes</enabled>
      <update_interval>1h</update_interval>
    </provider>

    <!-- Aggregate vulnerabilities -->
    <provider name="nvd">
      <enabled>yes</enabled>
      <update_from_year>2010</update_from_year>
      <update_interval>1h</update_interval>
    </provider>

  </vulnerability-detector>
  
  ########################################################## WAZUH Agent ##############################################################
